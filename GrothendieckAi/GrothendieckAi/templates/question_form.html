<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Math QA</title>
    <style>
        body { font-family: 'Helvetica Neue', sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
        .question-form { margin-bottom: 2rem; }
        textarea { width: 100%; padding: 0.5rem; font-size: 1rem; }
        .answer-box { background: #f0f0f0; padding: 1rem; border-radius: 8px; white-space: pre-wrap; }
        .chunks { margin-top: 1rem; font-size: 0.9rem; color: #444; }
    </style>

    <!-- âœ… MathJax CDN (v3) -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['\\[', '\\]'], ['$$', '$$']]
        },
        svg: { fontCache: 'global' }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
</head>
<body>

    <h1>Ask a Math Question</h1>

    <form method="POST" class="question-form">
        {% csrf_token %}
        <textarea name="question" rows="3" placeholder="What is a K3 surface?">{{ question }}</textarea><br>
        <button type="submit">Ask</button>
    </form>

    {% if answer %}
        <h2>Answer</h2>
        <div class="answer-box">
            {{ answer|safe }}
        </div>
    {% endif %}

    {% if retrieved_chunks %}
        <h3>Retrieved Chunks:</h3>
        <div class="chunks">
            <ul>
                {% for chunk in retrieved_chunks %}
                    <li>{{ chunk|truncatechars:300 }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

</body>
</html>
