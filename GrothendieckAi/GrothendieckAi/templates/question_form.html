<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Math QA</title>
    <style>
        body { font-family: 'Helvetica Neue', sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
        .question-form { margin-bottom: 2rem; }
        textarea { width: 100%; padding: 0.5rem; font-size: 1rem; }
        ul.pages-list { list-style-type: none; padding-left: 0; }
        ul.pages-list li { display: inline; margin-right: 1rem; }
        ul.pages-list li a { cursor: pointer; text-decoration: underline; color: blue; }
    </style>

    <!-- MathJax for LaTeX rendering -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['\\[', '\\]'], ['$$', '$$']]
        },
        svg: { fontCache: 'global' }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
</head>
<body>

    <h1>Ask a Math Question</h1>

    <form method="POST" class="question-form">
        {% csrf_token %}
        <textarea name="question" rows="3" placeholder="What is a K3 surface?">{{ question }}</textarea><br />
        <button type="submit">Ask</button>
    </form>

    {% if relevant_page %}
        <h3>Relevant PDF Page</h3>
        <ul class="pages-list">
            <li><a onclick="jumpToPage({{ relevant_page }}); return false;">Page {{ relevant_page }}</a></li>
        </ul>
    {% endif %}

    <h2>üìÑ Source Document</h2>
    <iframe
        src="{{ pdf_url }}"
        id="pdf-frame"
        width="100%"
        height="600px"
        style="border: 1px solid #ccc; border-radius: 8px;"
    ></iframe>

<script>
    function jumpToPage(page) {
        const iframe = document.getElementById('pdf-frame');
        iframe.src = "{{ pdf_url }}" + "#page=" + page;
    }

    // üîÅ Automatically jump on page load if relevant_page is available
    {% if relevant_page %}
        window.onload = function () {
            jumpToPage({{ relevant_page }});
        };
    {% endif %}
</script>


</body>
</html>
